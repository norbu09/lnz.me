<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>3 new destination markets in some months &#8211; Lenz Gschwendtner</title>
<meta name="description" content="It's been a bit of a busy time lately as we launched three new platforms in the last time and that brought with it a lot of challenges. Fortunately it also pushed me to complete our migration to our new backend which is now entirely message driven and based only on the finest stuff one finds in the moment.">
<meta name="keywords" content="post">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://lnz.me/images/site-logo.png">
<meta name="twitter:title" content="3 new destination markets in some months">
<meta name="twitter:description" content="It's been a bit of a busy time lately as we launched three new platforms in the last time and that brought with it a lot of challenges. Fortunately it also pushed me to complete our migration to our new backend which is now entirely message driven and based only on the finest stuff one finds in the moment.">
<meta name="twitter:creator" content="@norbu09">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="3 new destination markets in some months">
<meta property="og:description" content="It's been a bit of a busy time lately as we launched three new platforms in the last time and that brought with it a lot of challenges. Fortunately it also pushed me to complete our migration to our new backend which is now entirely message driven and based only on the finest stuff one finds in the moment.">
<meta property="og:url" content="http://lnz.me/articles/3-new-destination-markets-in-some-weeks/">
<meta property="og:site_name" content="Lenz Gschwendtner">





<link rel="canonical" href="http://lnz.me/articles/3-new-destination-markets-in-some-weeks/">
<link href="http://lnz.me/feed.xml" type="application/atom+xml" rel="alternate" title="Lenz Gschwendtner Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://lnz.me/assets/css/main.min.css">
<!-- Webfonts -->
<script src="//use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://lnz.me/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://lnz.me/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://lnz.me/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://lnz.me/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://lnz.me/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://lnz.me/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://lnz.me/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
	        
			<li>
				
					<a href="http://lnz.me/about/">About</a>
				 
			</li>
	        
			<li>
				
					<a href="http://lnz.me/articles/">Articles</a>
				 
			</li>
	        
	        <li><a href="http://lnz.me/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
	        <li class="dosearch"><i class="icon-search"></i> Search</li>
	        <li><a href="https://www.google.com/calendar/embed?src=ideegeo.com_95n2436gr0hoganq7am2tglsvg%40group.calendar.google.com&ctz=Pacific/Auckland" title="Calendar" target="new"> Meet</a></li>
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<div class="search-wrapper">
	<div class="search-form">
		<input type="text" class="search-field" placeholder="Search...">
		<i class="icon-remove-sign icon-2x"></i>
		<ul class="search-results post-list"></ul><!-- /.search-results -->
	</div><!-- /.search-form -->
</div><!-- ./search-wrapper -->

<header class="masthead">
	<div class="wrap">
        
    		<a href="http://lnz.me/" class="site-logo" rel="home" title="Lenz Gschwendtner"><img src="http://lnz.me/images/site-logo.png" width="200" height="200" alt="Lenz Gschwendtner logo" class="animated fadeInUp"></a>
        
        <h1 class="site-title animated fadeIn"><a href="http://lnz.me/">Lenz Gschwendtner</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">geek, mentor, punk</h2>
	</div>
</header><!-- /.masthead -->


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="http://lnz.me/tags/#post" title="Pages tagged post">post</a></span>
        
          <h1 class="entry-title">3 new destination markets in some months</h1>
        
      </header>
      <footer class="entry-meta">
        <img src="http://lnz.me/images/site-logo.png" alt="Lenz Gschwendtner photo" class="author-photo">
        <span class="author vcard">By <span class="fn"><a href="http://lnz.me/about/" title="About Lenz Gschwendtner">Lenz Gschwendtner</a></span></span>
        <span class="entry-date date published"><time datetime="2010-01-15T00:00:00+13:00"><i class="icon-calendar-empty"></i> January 15, 2010</time></span>
        <span class="entry-date date modified"><time datetime="2010-01-15"><i class="icon-pencil"></i> January 15, 2010</time></span>
        
        <span><a href="http://lnz.me/articles/3-new-destination-markets-in-some-weeks/" rel="bookmark" title="3 new destination markets in some months"><i class="icon-link"></i> Permalink</a></span>
        
        <span class="social-share-facebook">
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://lnz.me/articles/3-new-destination-markets-in-some-weeks/" title="Share on Facebook" itemprop="Facebook"><i class="icon-facebook-sign"></i> Like</a></span>
        <span class="social-share-twitter">
            <a href="https://twitter.com/intent/tweet?hashtags=articles&text=3 new destination markets in some months&url=http://lnz.me/articles/3-new-destination-markets-in-some-weeks/&via=norbu09" title="Share on Twitter" itemprop="Twitter"><i class="icon-twitter-sign"></i> Tweet</a></span>
        <span class="social-share-googleplus">
            <a href="https://plus.google.com/share?url=http://lnz.me/articles/3-new-destination-markets-in-some-weeks/" title="Share on Google Plus" itemprop="GooglePlus"><i class="icon-google-plus-sign"></i> +1</a></span>
            <!-- /.social-share -->
      </footer>
      <div class="entry-content">
        <h1 id="three-new-destination-markets-in-some-months">Three new destination markets in some months</h1>

<p>It’s been a bit of a busy time lately as we launched three new platforms
in the last time and that brought with it a lot of challenges.
Fortunately it also pushed me to complete our migration to our new
backend which is now entirely message driven and based only on the
finest stuff one finds in the moment.</p>

<p>The backend engine is <a href="http://rabbitmq.com">RabbitMQ</a> based and persists messages to
<a href="http://couchdb.apache.org">CouchDB</a> if necessary. We have a simple home grown workflow engine
that enables us to easily customise and change flows like what happens
if a domain gets registered or exactly when we charge a user. I spoke
about an early version of this workflow engine last year at the erlounge
Wellington
(http://norbu09.org/2009/10/15/one-system-to-rule-them-all.html). This
backend engine is a scalable hub for tasks and the main challenge was to
make our frontend stupid simple and more or less only a wrapper for
tasks happening in the backend. We have now nearly all the logic moved
and the frontend is quite slim, holding only the e-commerce and user
profile functionality whereas all the domain specific functionality
moved out.</p>

<p>The next step was to make our frontend not only simple but also
brandable and multi currency/language. This is the moment where you
notice that strings are everywhere and solid internal APIs pay off big
time. This challenge was a big one but we managed to master it and have
now an <a href="http://iWantMyName.com">English</a>, <a href="http://meinName.com">German</a> and <a href="http://benikvrij.nl">Dutch</a> version online selling
in USD, EUR and <a href="http://iWantMyName.co.nz">NZD</a>. The frontend is a generic one that has many
configuration knobs that can tweak the functionality but it is still
only one code base for all projects. The template sets are separate so
each language has its own template set. The two English speaking
platforms share a template set but have different currencies - the
content however is not 100% the same on the two. All this needs lots of
config variables to check against and Template::Toolkit was a big help
here.</p>

<p>As you can see there went a lot of effort into designing a flexible
system that can act in different environments and still be only
one system. Most of the content is now served out of CouchDB and we
further reduced the amount of data stored in PostgreSQL as well as hard
coded texts in templates. We rewrote our shopping card from scratch and
the checkout process is really simple now as most of the heavy lifting
is now in the backend. Stuff we are working on in the moment is Session
handling and user management in CouchDB with a goal to strip out
PostgreSQL entirely (the according Catalyst::Plugins are on the way).
Don’t get me wrong, we love PostgreSQL but there is no need for it
anymore once we have the remaining things ported over to CouchDB. It
simplifies our stack and reduces our admin overhead.</p>

<p>Speaking of admin overhead - we also run all setups (including local
development VMs) off a puppet setup and code/template/CouchDB rollout is
done via capistrano which turns out to work quite well with catalyst and
perl. We roll out a new frontend webserver in about half an hour 
from bare debian to running frontend with the most time being spent
waiting for puppet and no manual step other then installing puppet.</p>

<p>You see we have been busy, if you find bugs, report them. We know that
the performance in the DNS editor is still crap but we try to sort that
and there are some rough edges here and there but most of the platforms
should run smoothly. It was a steep learning curve once again but we
managed to create a scalable system that is extremely flexible and fast.</p>

<p>… hope you like it …</p>


        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="http://lnz.me/articles/one-system-to-rule-them-all/" class="btn" title="one system to rule them all">Previous article</a>
      
      
        <a href="http://lnz.me/articles/slides-from-LCA-talk/" class="btn" title="slides from LCA talk">Next article</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2015 Lenz Gschwendtner. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/so-simple/">So Simple Theme</a>.</span>
<div class="social-icons">
	<a href="http://twitter.com/norbu09" title="Lenz Gschwendtner on Twitter" target="_blank"><i class="icon-twitter icon-2x"></i></a>
	
	
	<a href="http://linkedin.com/in/lenzgschwendtner" title="Lenz Gschwendtner on LinkedIn" target="_blank"><i class="icon-linkedin icon-2x"></i></a>
	
	
	
	<a href="http://github.com/norbu09" title="Lenz Gschwendtner on Github" target="_blank"><i class="icon-github icon-2x"></i></a>
	
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://lnz.me/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://lnz.me/assets/js/scripts.min.js"></script>

<!-- Jekyll Simple Search option -->
<script>
  $(document).ready(function() {
      $('.search-field').simpleJekyllSearch({
          jsonFile : 'http://lnz.me/search.json',
          searchResults : '.search-results',
          template : '<li><article><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></article></li>',
          noResults: '<p>Nothing found.</p>'
        });
  });

  (function( $, window, undefined ) {
    
     var bs = {
          close: $(".icon-remove-sign"),
          searchform: $(".search-form"),
          canvas: $("body"),
          dothis: $('.dosearch')
      };
    
    bs.dothis.on('click', function() {
      $('.search-wrapper').css({ display: "block" });
      bs.searchform.toggleClass('active');
      bs.searchform.find('input').focus();
      bs.canvas.toggleClass('search-overlay');
    });
    
      bs.close.on('click', function() {
        $('.search-wrapper').removeAttr( 'style' );
        bs.searchform.toggleClass('active');
        bs.canvas.removeClass('search-overlay');
    });
  })( jQuery, window );
</script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl = 
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-9729535-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

	        

</body>
</html>
